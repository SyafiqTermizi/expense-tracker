{% extends "base.html" %}
{% load static %}
{% load humanize %}

{% block content %}
<div class="row mt-4">
    <div class="col-md-8 col-sm-12">
        <h3>
            Expenses for event {{ event.name }}
        </h3>
        <p class="text-secondary">
            {% if event.active %}
            Started on {{ event.start_date|date:"d M Y" }} and will end on {{ event.end_date|date:"d M Y" }}.
            <span class="text-success">
                <b>Active</b>
            </span>
            {% else %}
            Started on {{ event.start_date|date:"d M Y" }} and ended on {{ event.end_date|date:"d M Y" }}.
            <span class="text-danger">
                <b>Inactive</b>
            </span>
            {% endif %}
        </p>
        <p>You've spent <b>{{ request.user.currency }}  {{ total_expense.total }}</b> for this event.</p>
    </div>
    <div class="col-md-4 col-sm-12 text-md-end text-sm-start">
        <a href="{% url 'events:update' event.slug %}" class="mt-3 btn btn-outline-primary">Edit detail</a>
        <a class="mt-3 btn btn-danger" href="{% url 'events:delete' event.slug %}">Delete</a>
    </div>
</div>

<div class="row mt-3">
    <div class="col-12">
        Spending breakdown by:
    </div>
</div>

<div class="row mb-5">
    <div class="col-md-6 col-sm-12 mt-2">
        <div class="card">
            <div class="card-body">
                <h4 id="chart-title" class="card-title">
                    Category
                </h4>
                <div id="category-chart"></div>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-sm-12 mt-2">
        <div class="card">
            <div class="card-body">
                <h4 id="chart-title" class="card-title">
                    Account
                </h4>
                <div id="account-chart"></div>
            </div>
        </div>
    </div>
</div>

{% include "partial/transaction_table.html" with transactions=expenses hide_filter="true" %}

{{ expense_by_category|json_script:"expense-by-category" }}
{{ expense_by_account|json_script:"expense-by-account" }}
<script src="{% static 'expenseDetail.js' %}"></script>
{% endblock content %}
